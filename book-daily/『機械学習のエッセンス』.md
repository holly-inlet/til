# 『機械学習のエッセンス』読書記録

> 『機械学習のエッセンス -実装しながら学ぶPython,数学,アルゴリズム-』  
> 著者：加藤 公一  
> 出版社：SBクリエイティブ  
> ISBN：9784797393965  
> ![『機械学習のエッセンス -実装しながら学ぶPython,数学,アルゴリズム-』](https://www.hanmoto.com/bd/img/9784797393965.jpg?2018-09-26T16%3A40%3A26%2B09%3A00)

## 概要

このページでは私が『機械学習のエッセンス』を読みながらつけていた感想の記録を公開している。

書評というよりは読書感想の寄せ集めである。正直に言うと，私は本書の2割ほどしか理解できていないと思うので，要約も解説もできず，本書について何か意見するのもおこがましい。それでも，私のような本書のレベルに見合っていないクソザコ読者がどのような感想を抱いたのかという事例が，他の読者の方々を励ますことができれば良いと思い，恥ずかしげもなく公開することにした。

本書を読む過程で私がどんなことを考えたのか関心を持ってくれる方はこのまま読み進めて欲しい。

それは長いので，一応最後に読み終えた感想をまとめてある。

- 読書期間：　2021/08/06 - 2021/09/10
- 前提
  - 私は本書を読んだ時点で，Pythonと高校数学を学び始めたばかりであった。
    - 同時期に，Pythonはオンライン学習サービスPyQ，高校数学は『基礎と演習』（白チャート）を始めた。詳しくは[こちら](../2021/2021summer-vacation-plan.md)
    - 数学は大の苦手で，高校数学はこれまで習ってないに等しい。
  - 大学の授業で統計学は学んでおり，SPSSなどで分散分析や回帰分析は行える。しかし，数式を交えた理論的な部分はさっぱりわからない。
- 本書を読んだ目的
  - 機械学習でどんなことをするのか全く想像がつかなかったので，機械学習の入門書として本書を選んだ。
  - PyQで機械学習を扱う問題があるので，そこに到達する前に機械学習についてまとまった内容を知っておきたかった。
  - そもそもなぜ機械学習を学ぼうと考えたのかは[こちら](../README.md)

## 目次

- [概要](#概要)
- [目次](#目次)
- [§ 第01章 学習を始める前に](#-第01章-学習を始める前に)
- [§ 第02章 Pythonの基本](#-第02章-pythonの基本)
- [§ 第03章 機械学習に必要な数学](#-第03章-機械学習に必要な数学)
- [§ 第04章 Pythonによる数値計算](#-第04章-pythonによる数値計算)
- [§ 第05章 機械学習アルゴリズム](#-第05章-機械学習アルゴリズム)
- [感想まとめ](#感想まとめ)

<br/>

- [感想まとめ](#感想まとめ)

## § 第01章 学習を始める前に

- ¶ 01 本書の目的
  > 本書の目的が初めに書かれているのは，本書の用途を見極める時にわかりやすくて良い。
- ¶ 02 本書は何を含まないか
  - 適切な機械学習アルゴリズムの選び方
  - 最適な実装
  - ディープラーニング（深層学習）
  > 本書に含まない項目を明示している点も，それらを含む資料を意識的に探しやすくなるので良い。アルゴリズムの選び方や実装については『見て試してわかる機械学習アルゴリズムの仕組み 機械学習図鑑』に期待。ディープラーニングもここで学ぶとお腹一体になりそうなので，別の本できっちり学ぶ方が良いと私も思う。
- ¶ 03 機械学習の初歩
- ¶ 04 実行環境の準備
  - 何をどうインストールするか
  - Anacondaのインストール
    - Windowsの場合
    - macOSの場合
    - Linuxの場合
  - その他の選択肢
  - サンプルコードのダウンロード
  > 実行環境構築については，ここに載っている内容では足りないような気がする。そのための参考資料は紹介されているが，それらを読み最適解を見つけ出すまでに時間がかかりそうである。環境構築は腰を据えて取り組まないと痛い目を見る（見た）だろう。
- ¶ Column Pythonのバーションについて

## § 第02章 Pythonの基本

> 章の扉に`「ある程度のプログラミング経験がある人がPythonの文法と機能を概観することを目標としています。」`と書かれている通り，ここでPythonを学べるというよりは，これから機械学習を学ぶにあたっての復習ができると考えた方が良いだろう。

- ¶ 01 プログラムの実行方法
  - REPL
    - ファイルの実行
  - Jupyter Notebook
    - プログラムの実行
    - ファイルの実行
    - グラフの表示
    - Jupyter Notebookの終了
- ¶ 02 基本的な文法
  - コメント
- ¶ 03 数値と文字列
  > 特別難しいことではないが知らなかった項目がいくつもあった。やはり，一通り基礎を体系立てて学ぶのは大事だと思う。PyQで学習はしているが，『みんなのPython』もリファレンスとして使うだけでなく，一度目を通した方が良いだろう。
- ¶ 04 複数行処理
  > ここの内容はまるっきり知らなかった。文の途中で改行するとエラーを起こすことや，それを避けるための方法として，バックスラッシュを入れたり括弧でくくることを知れたのは，プログラムを実行する上では必ずしも重要でないかも知れないが，見やすさを工夫する時に便利になるだろう。
- ¶ 05 制御構造
  > 「FizzBuzz問題」は一度空で解いてみたい。多分現段階では何のヒントもなしに解くことはできないだろう。行っていることは難しくないが，問題文を読んで解法を思い出せるほどやり方が定着していない。このくらいは瞬間的に思いつけるようになりたい。
- ¶ 06 リスト，辞書，集合
  - リスト
  - タプル
  - シーケンス型
  - 辞書
  - 集合（Set）
  > シーケンス型や集合型という用語はまだ学んだことがなかったので，どういった時に使うものなのか，今後ちゃんと知りたい。
- ¶ 07 関数定義
- ¶ 08 オブジェクト指向
  - 標準ライブラリの利用
  - クラス定義
- ¶ 09 モジュール
  - モジュールの作成
- ¶ 10 ファイル操作
  - pickleモジュールの利用
    - その他のファイル形式
- ¶ 11 例外処理
- ¶ Column Pythonで何ができるか

> 後半部分の内容を読んだ時点では，その範囲をまだPyQで学習していないが，書かれているコードは説明を読めば理解できたので，予習として良かったと思う。ただし，ここに書いてる程度の知識でこの先機械学習の実装がどれくらいできるのかは疑問が残る。まぁその箇所に到達する頃にはPyQで基礎的な内容は終えているだろうし大丈夫だろう。

## § 第03章 機械学習に必要な数学

> この本と平行して『白チャート』にて高校数学を学習はしているが，上手く行っているとは言えず，本書のこの箇所を読むのにも不安は大きい。それでも，本書では`「数学的事実には必ずしも証明はつけず，そのかわりに直感的な説明をつけることとします。」`と書いてあるので，ある程度理解はできるかもしれない，という期待を持って読み進めようと思う。

- ¶ 01 基本事項の確認
  - 集合
  - 数列
  - 写像と関数
  > 写像に入った瞬間全くわからなくなった。数列までは統計学の基礎を学ぶ時に復習したことがあるが，写像は初耳だからだと思う。『白チャート』の方で写像を学ぶのはいつになるかわからないが，取り敢えずはわかったふりをして読み進めてみよう。わからなければいくらでも読み返して復習はできるので。
- ¶ 02 線形代数
  - ベクトルの基本
    > 節末の練習問題は解けた。まだ大丈夫。落ち着いていこう。
  - ベクトルの内積
    > 例題の2問目は何をやっているのかわからなかった。『白チャート』をある程度進めてからもう一度見直してみればわかるかもしれない。
  - ベクトルの幾何的イメージ
    > 練習問題はさっぱりわからない。ベクトルの引き算までは何をやってどうなっているのかわかったが，パラメーター表示の説明から式が追えなくなった。ここで悩んでいてもどうにかなる問題ではないと思うので，ひとまず置いておいて先に進む。
  - 行列の基本
  - 行列の演算
  - ブロック化による演算の効率化
  - 逆行列と連立方程式
  - 逆行列と線形独立性
  - 一次変換
  - 固有値
  - 直交行列
  - 対称行列
  > 内容はほとんど理解できなかったが，それでも後から文章の構造がわかりやすくなるように書き込みながら読み進めていった。世の中には数ヶ月で機械学習が使えるようになる学習講座があったりするが，今回学んだ範囲だけで考えても，とてもそんなことは出来ないように思える。デフォルトで必要とされるレベルが高いのか，それとも十分なレベルまでは行けないのか，はたまた機械学習を使うにはそこまで数学の理解はいらないのか。数学の学習を止める選択肢はないが，最後の理由であるならば少しはこのままデータサイエンスを学び続ける希望は持てそうなのだが。
- ¶ 03 微積分
  - 極限
  - 指数関数
  - 対数関数
  - 微分
  - 多項式の微分
  - 積・商の微分と高階導関数
  - 合成関数と対数関数の微分
  - べき乗の微分
  - 関数の増減と極大・極小
  - 不定積分
  - 定積分
  - 偏微分と勾配  
  > 始めから全く内容は理解できなかった。そもそも数学1さえ学習し終えていない現段階でわかる内容ではないと割り切り，登場する専門用語に慣れるための第一歩であると考えて，あまり考え込まずに一通り目を通すことを目的に読んだ。後々機械学習に接する中で数学的にわからない所が出てきたら，その時適宜参照できるようにしておこう。もし仮に，ここでの内容を完全に理解しなければこの先機械学習を使っていけないとしたら，業務やコンペに参加できるようになるまで一体どれほどの時間がかかるのだろう。

## § 第04章 Pythonによる数値計算

- ¶ 01 数値計算の基本
  - 浮動小数点の演算
  - 演算による桁落ち
  - 数値範囲の考慮
- ¶ 02 NumPyの基本
  - NumPyの配列
  - 2次元配列
  - 配列のデータ属性
  - reshapeメソッドと形状の変更
  - その他配列の操作
  - 行列の連結
- ¶ 03 配列の基本計算
  - ブロードキャスト
  - 配列の演算
- ¶ 04 疎行列
- ¶ 05 NumPy/SciPyによる線形代数
- ¶ 06 乱数
  - 再現性と乱数の種
- ¶ 07 データの可視化
  - 折れ線グラフ
  - 散布図
  - 曲線のグラフ
  - 複数の線を表示する
  - ヒストグラム
  - 複数のグラフを並べて表示する
  - 等高線の描画
- ¶ 08 数理最適化
  - 線形計画問題
  - 2次計画法
  - 勾配降下法
  - ニュートン法
  - ラグランジュ未定乗数法
- ¶ 09 統計
  - 統計基本量
  - 正規分布と確率密度関数
  
> 全くわからないが，数理最適化の内容に入ってから「こんなことができたら面白いだろうな」と思えてきた。いや，何をしているかは全く追えていないのだが，例として出された線形計画問題の問題文を見て，こういう現実の問題が解けるようになりたいと思った。ただし，現状は機械学習や数理最適化問題どころの話ではなく，NumpyやMatplotlibを使えるかどうかさえ怪しく，それは数学ができていないからであり，先行きは長く険しい。ここにきて，数学を今のように急いで学ぶのではなく，本腰を入れてじっくり丁寧に学び直したいと思えてくる。数学もとい算数は子供の頃からの難敵であったが，ここまできてやっと立ち向かえる力がついたのだと言える。しかし，時すでに遅し，しっかりと相手取るには融通の聞く時間が少なくなってしまった。これからの戦いで一体どこまで行けるだろうか。

## § 第05章 機械学習アルゴリズム

- ¶ 01 準備
  - 入力データについて
  - 用語
  - インターフェース
- ¶ 02 回帰
  - 原点を通る直線による近似
  - 一般の直線による近似
  - 特徴量ベクトルが多次元の場合
  - 実践的な例
  - 機械学習アルゴリズムの評価について
- ¶ 03 リッジ回帰
  - ハイパーパラメータとチューニング
- ¶ 04 汎化と過学習
  - モデルの汎化性能
  - 交差検証
- ¶ 05 ラッソ回帰
  - 文献に関するメモ
- ¶ 06 ロジスティック回帰
- ¶ 07 サポートベクタマシン
  - 分離不可能な場合
  - カーネル法
  - 文献に関するメモ
- ¶ 08 k-Means法
- ¶ 09 主成分分析（PCA）
  - 多次元への射影と特異値分解
  - PCAのアルゴリズム

> 回帰分析や主成分分析は大学の統計学の授業で学習したので少しは理解できる部分もあるかと思ったが，駄目であった。それも当然で，学習したと言っても使い方や使うにあたっての考え方を学んだだけで，あまり理論的な部分には踏み込まずに教えてもらっていた。そのおかげで，私は数学が全くわからなくとも統計学に興味を持つことができたが，そうなるとやはりこうして理論的な数学の部分を避けては通れないということなのだろう。ただし，本書を読む前は機械学習で何をするのか全く想像ができなかったが，ここに来て自分の知っていることとそこまで遠くないのだとわかった点は良かったと思う。

## 感想まとめ

一応は本文全てに目を通し，後で見返すのに役立つように書き込みをしたが，内容を理解できたとは全くもって言えない。その理由は，私の数学に関する理解が乏しいことに尽きる。折角本書がPythonや数学の内容から機械学習まで段階を経て説明してくれているのに，その数学の初歩的な段階で躓いてしまった。取り組むのが時期尚早であったと言わざるを得ない。しかし，それでも得たものとして，機械学習を理解するまでの道筋が掴め，その中で自分の具体的なレベル・現在地が知れたことは今後の学習計画に大きく役立つだろう。これは本書ならではの利点であったと感じた。

本書は機械学習に必要なプログラミング（Python）から始まり，数学の集合・数列，そして線形代数・微積分，Pythonで数学の内容を実現するためのNumPy・SciPy・Matplotlibの使い方を経て，最後の章でやっと機械学習に触れており，全5章中1章のみ機械学習を扱うというまさに「機械学習のエッセンス」を解説する本であると言える。そうして機械学習の前段階から順を追って解説してくれたからこそ，「機械学習わからん」と放り出さずに，「数学のこの部分がわからないからまずはここから始めよう」と建設的で現実的な方略に移りやすかったと思える。

私の場合は，初めはできるだけ早くにKaggleやSIGNATEに参加しようと考えていたが，今はもっと着実にPythonで何かしら簡単な分析や可視化などのポートフォリオを作ることを目標に学ぼうと考え直した。それで大学を卒業した時にデータサイエンティストという職につけなくとも仕方あるまい。分相応である。だからと言って，私のやりたいことは変わっていない。むしろ，本書で数理最適化問題を垣間見て，よりデータにまつわる仕事が面白そうに思えた。あまり自分への期待値を上げることはできないが，色々と勉強して周ってきて，再び本書に目を通した時，自らの成長を実感できるように精進しようと思う。
